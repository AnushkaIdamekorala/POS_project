68d7438fc5cd945a554090459eb1c954
"use strict";

var _interopRequireWildcard = require("/home/anushkai/Desktop/Training/code/redux/fullStack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("/home/anushkai/Desktop/Training/code/redux/fullStack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/interopRequireDefault");

var _reduxMockStore = _interopRequireDefault(require("redux-mock-store"));

var _reduxThunk = _interopRequireDefault(require("redux-thunk"));

var actions = _interopRequireWildcard(require("./cartActions"));

var types = _interopRequireWildcard(require("./types"));

var _expect = _interopRequireDefault(require("expect"));

var _regeneratorRuntime = _interopRequireDefault(require("regenerator-runtime"));

var _moxios = _interopRequireDefault(require("moxios"));

const middlewares = [_reduxThunk.default];
const mockStore = (0, _reduxMockStore.default)(middlewares);
describe("getCart cartActions", () => {
  beforeEach(function () {
    _moxios.default.install();
  });
  afterEach(function () {
    _moxios.default.uninstall();
  });
  test("correctly", () => {
    const expectedArray = [{
      _id: "5c6e3f2ccd583f2bd04e55cc",
      itm: {
        _id: "5c67bb90f004c93ecd7006bf",
        name: "Coke",
        productCode: 2,
        price: 100,
        description: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec iaculis metus dolor, at mollis ",
        availableCount: 500,
        __v: 0
      },
      count: 1
    }, {
      _id: "5c6e3fbc461b152d009ba691",
      itm: {
        _id: "5c67bd07f004c93ecd7006c6",
        name: "Ice Cream",
        productCode: 9,
        price: 120,
        description: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec iaculis metus dolor, at mollis ",
        availableCount: 170,
        __v: 0
      },
      count: 1
    }, {
      _id: "5c6e5d167d83b649d32e3c0c",
      itm: {
        _id: "5c67bbc7f004c93ecd7006c0",
        name: "Apple",
        productCode: 3,
        price: 80,
        description: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec iaculis metus dolor, at mollis ",
        availableCount: 600,
        __v: 0
      },
      count: 4
    }, {
      _id: "5c6fce27dedd73364924ed67",
      itm: {
        _id: "5c67bc01f004c93ecd7006c2",
        name: "Milk",
        productCode: 5,
        price: 200,
        description: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec iaculis metus dolor, at mollis ",
        availableCount: 400,
        __v: 0
      },
      count: 4
    }, {
      _id: "5c7379de4316081c7de67208",
      itm: {
        _id: "5c67bc28f004c93ecd7006c3",
        name: "Cheese",
        productCode: 6,
        price: 350,
        description: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec iaculis metus dolor, at mollis ",
        availableCount: 70,
        __v: 0
      },
      count: 1
    }];

    _moxios.default.wait(() => {
      const request = _moxios.default.requests.mostRecent();

      request.respondWith({
        status: 200,
        response: expectedArray
      });
    });

    const expectedActions = [{
      type: types.CART_LOADING
    }, {
      payload: expectedArray,
      type: types.GET_CART
    }];
    const store = mockStore({
      cartItems: [],
      totalAmount: 0,
      cartLoading: false,
      cartId: "5c6a4c226c7e0a0f2c7ea2fb"
    });
    return store.dispatch(actions.getCart()).then(() => {
      // return of async actions
      (0, _expect.default)(store.getActions()).toEqual(expectedActions);
    });
  });
});
describe("addToCart cartActions", () => {
  beforeEach(function () {
    _moxios.default.install();
  });
  afterEach(function () {
    _moxios.default.uninstall();
  });
  test("correctly", () => {
    _moxios.default.wait(() => {
      const request = _moxios.default.requests.mostRecent();

      request.respondWith({
        status: 200,
        response: [1, 2, 3, 4]
      });
    });

    const expectedActions = [{
      payload: [1, 2, 3, 4],
      type: types.ADD_TO_CART
    }];
    const store = mockStore({
      cartItems: [],
      total: 0,
      cartLoading: false
    });
    const id = "5c6bf6cdd2104b6379fdf49c";
    const count = 6;
    return store.dispatch(actions.addToCart(id, count)).then(() => {
      // return of async actions
      (0, _expect.default)(store.getActions()).toEqual(expectedActions);
    });
  });
});
describe("deleteFromCart cartActions", () => {
  beforeEach(function () {
    _moxios.default.install();
  });
  afterEach(function () {
    _moxios.default.uninstall();
  });
  test("correctly", () => {
    _moxios.default.wait(() => {
      const request = _moxios.default.requests.mostRecent();

      request.respondWith({
        status: 200,
        response: {
          success: true
        }
      });
    });

    const id = "5c6bf6cdd2104b6379fdf49c";
    const expectedActions = [{
      payload: id,
      type: types.DELETE_FROM_CART
    }];
    const store = mockStore({
      cartItems: [],
      total: 0,
      cartLoading: false
    });
    return store.dispatch(actions.deleteFromCart(id)).then(() => {
      // return of async actions
      (0, _expect.default)(store.getActions()).toEqual(expectedActions);
    });
  });
});
describe("updateCount cartActions", () => {
  beforeEach(function () {
    _moxios.default.install();
  });
  afterEach(function () {
    _moxios.default.uninstall();
  });
  test("correctly", () => {
    _moxios.default.wait(() => {
      const request = _moxios.default.requests.mostRecent();

      request.respondWith({
        status: 200,
        response: {
          success: true
        }
      });
    });

    const id = "5c6bf6cdd2104b6379fdf49c";
    const count = 4;
    const expectedActions = [{
      payload: {
        idd: id,
        countt: count
      },
      type: types.UPDATE_COUNT
    }];
    const store = mockStore({
      cartItems: [],
      total: 0,
      cartLoading: false
    });
    return store.dispatch(actions.updateCount(id, count)).then(() => {
      // return of async actions
      (0, _expect.default)(store.getActions()).toEqual(expectedActions);
    });
  });
});
describe("clearCart cartActions", () => {
  beforeEach(function () {
    _moxios.default.install();
  });
  afterEach(function () {
    _moxios.default.uninstall();
  });
  test("correctly", () => {
    _moxios.default.wait(() => {
      const request = _moxios.default.requests.mostRecent();

      request.respondWith({
        status: 200,
        response: {
          success: true
        }
      });
    });

    const expectedActions = [{
      payload: {
        success: true
      },
      type: types.CLEAR_CART
    }];
    const store = mockStore({
      cartItems: [],
      total: 0,
      cartLoading: false
    });
    return store.dispatch(actions.clearCart()).then(() => {
      // return of async actions
      (0, _expect.default)(store.getActions()).toEqual(expectedActions);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhckFjdGlvbnMudGVzdC5qcyJdLCJuYW1lcyI6WyJtaWRkbGV3YXJlcyIsInRodW5rIiwibW9ja1N0b3JlIiwiZGVzY3JpYmUiLCJiZWZvcmVFYWNoIiwibW94aW9zIiwiaW5zdGFsbCIsImFmdGVyRWFjaCIsInVuaW5zdGFsbCIsInRlc3QiLCJleHBlY3RlZEFycmF5IiwiX2lkIiwiaXRtIiwibmFtZSIsInByb2R1Y3RDb2RlIiwicHJpY2UiLCJkZXNjcmlwdGlvbiIsImF2YWlsYWJsZUNvdW50IiwiX192IiwiY291bnQiLCJ3YWl0IiwicmVxdWVzdCIsInJlcXVlc3RzIiwibW9zdFJlY2VudCIsInJlc3BvbmRXaXRoIiwic3RhdHVzIiwicmVzcG9uc2UiLCJleHBlY3RlZEFjdGlvbnMiLCJ0eXBlIiwidHlwZXMiLCJDQVJUX0xPQURJTkciLCJwYXlsb2FkIiwiR0VUX0NBUlQiLCJzdG9yZSIsImNhcnRJdGVtcyIsInRvdGFsQW1vdW50IiwiY2FydExvYWRpbmciLCJjYXJ0SWQiLCJkaXNwYXRjaCIsImFjdGlvbnMiLCJnZXRDYXJ0IiwidGhlbiIsImdldEFjdGlvbnMiLCJ0b0VxdWFsIiwiQUREX1RPX0NBUlQiLCJ0b3RhbCIsImlkIiwiYWRkVG9DYXJ0Iiwic3VjY2VzcyIsIkRFTEVURV9GUk9NX0NBUlQiLCJkZWxldGVGcm9tQ2FydCIsImlkZCIsImNvdW50dCIsIlVQREFURV9DT1VOVCIsInVwZGF0ZUNvdW50IiwiQ0xFQVJfQ0FSVCIsImNsZWFyQ2FydCJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUEsTUFBTUEsV0FBVyxHQUFHLENBQUNDLG1CQUFELENBQXBCO0FBQ0EsTUFBTUMsU0FBUyxHQUFHLDZCQUFtQkYsV0FBbkIsQ0FBbEI7QUFFQUcsUUFBUSxDQUFDLHFCQUFELEVBQXdCLE1BQU07QUFDcENDLEVBQUFBLFVBQVUsQ0FBQyxZQUFXO0FBQ3BCQyxvQkFBT0MsT0FB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aEIsRUFBaEI7O0FBQ0FGLE1BQUFBLE9BQU8sQ0FBQ0csV0FBUixDQUFvQjtBQUNsQkMsUUFBQUEsTUFBTSxFQUFFLEdBRFU7QUFFbEJDLFFBQUFBLFFBQVEsRUFBRTtBQUFFc0IsVUFBQUEsT0FBTyxFQUFFO0FBQVg7QUFGUSxPQUFwQjtBQUlELEtBTkQ7O0FBUUEsVUFBTXJCLGVBQWUsR0FBRyxDQUN0QjtBQUNFSSxNQUFBQSxPQUFPLEVBQUU7QUFBRWlCLFFBQUFBLE9BQU8sRUFBRTtBQUFYLE9BRFg7QUFFRXBCLE1BQUFBLElBQUksRUFBRUMsS0FBSyxDQUFDMEI7QUFGZCxLQURzQixDQUF4QjtBQU9BLFVBQU10QixLQUFLLEdBQUcvQixTQUFTLENBQUM7QUFBRWdDLE1BQUFBLFNBQVMsRUFBRSxFQUFiO0FBQWlCVyxNQUFBQSxLQUFLLEVBQUUsQ0FBeEI7QUFBMkJULE1BQUFBLFdBQVcsRUFBRTtBQUF4QyxLQUFELENBQXZCO0FBRUEsV0FBT0gsS0FBSyxDQUFDSyxRQUFOLENBQWVDLE9BQU8sQ0FBQ2lCLFNBQVIsRUFBZixFQUFvQ2YsSUFBcEMsQ0FBeUMsTUFBTTtBQUNwRDtBQUNBLDJCQUFPUixLQUFLLENBQUNTLFVBQU4sRUFBUCxFQUEyQkMsT0FBM0IsQ0FBbUNoQixlQUFuQztBQUNELEtBSE0sQ0FBUDtBQUlELEdBdEJHLENBQUo7QUF1QkQsQ0FoQ08sQ0FBUiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjb25maWd1cmVNb2NrU3RvcmUgZnJvbSBcInJlZHV4LW1vY2stc3RvcmVcIjtcbmltcG9ydCB0aHVuayBmcm9tIFwicmVkdXgtdGh1bmtcIjtcbmltcG9ydCAqIGFzIGFjdGlvbnMgZnJvbSBcIi4vY2FydEFjdGlvbnNcIjtcbmltcG9ydCAqIGFzIHR5cGVzIGZyb20gXCIuL3R5cGVzXCI7XG5pbXBvcnQgZXhwZWN0IGZyb20gXCJleHBlY3RcIjtcbmltcG9ydCByZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSBcInJlZ2VuZXJhdG9yLXJ1bnRpbWVcIjtcbmltcG9ydCBtb3hpb3MgZnJvbSBcIm1veGlvc1wiO1xuXG5jb25zdCBtaWRkbGV3YXJlcyA9IFt0aHVua107XG5jb25zdCBtb2NrU3RvcmUgPSBjb25maWd1cmVNb2NrU3RvcmUobWlkZGxld2FyZXMpO1xuXG5kZXNjcmliZShcImdldENhcnQgY2FydEFjdGlvbnNcIiwgKCkgPT4ge1xuICBiZWZvcmVFYWNoKGZ1bmN0aW9uKCkge1xuICAgIG1veGlvcy5pbnN0YWxsKCk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaChmdW5jdGlvbigpIHtcbiAgICBtb3hpb3MudW5pbnN0YWxsKCk7XG4gIH0pO1xuXG4gIHRlc3QoXCJjb3JyZWN0bHlcIiwgKCkgPT4ge1xuICAgIGNvbnN0IGV4cGVjdGVkQXJyYXkgPSBbXG4gICAgICB7XG4gICAgICAgIF9pZDogXCI1YzZlM2YyY2NkNTgzZjJiZDA0ZTU1Y2NcIixcbiAgICAgICAgaXRtOiB7XG4gICAgICAgICAgX2lkOiBcIjVjNjdiYjkwZjAwNGM5M2VjZDcwMDZiZlwiLFxuICAgICAgICAgIG5hbWU6IFwiQ29rZVwiLFxuICAgICAgICAgIHByb2R1Y3RDb2RlOiAyLFxuICAgICAgICAgIHByaWNlOiAxMDAsXG4gICAgICAgICAgZGVzY3JpcHRpb246XG4gICAgICAgICAgICBcIkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0LCBjb25zZWN0ZXR1ciBhZGlwaXNjaW5nIGVsaXQuIERvbmVjIGlhY3VsaXMgbWV0dXMgZG9sb3IsIGF0IG1vbGxpcyBcIixcbiAgICAgICAgICBhdmFpbGFibGVDb3VudDogNTAwLFxuICAgICAgICAgIF9fdjogMFxuICAgICAgICB9LFxuICAgICAgICBjb3VudDogMVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgX2lkOiBcIjVjNmUzZmJjNDYxYjE1MmQwMDliYTY5MVwiLFxuICAgICAgICBpdG06IHtcbiAgICAgICAgICBfaWQ6IFwiNWM2N2JkMDdmMDA0YzkzZWNkNzAwNmM2XCIsXG4gICAgICAgICAgbmFtZTogXCJJY2UgQ3JlYW1cIixcbiAgICAgICAgICBwcm9kdWN0Q29kZTogOSxcbiAgICAgICAgICBwcmljZTogMTIwLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOlxuICAgICAgICAgICAgXCJMb3JlbSBpcHN1bSBkb2xvciBzaXQgYW1ldCwgY29uc2VjdGV0dXIgYWRpcGlzY2luZyBlbGl0LiBEb25lYyBpYWN1bGlzIG1ldHVzIGRvbG9yLCBhdCBtb2xsaXMgXCIsXG4gICAgICAgICAgYXZhaWxhYmxlQ291bnQ6IDE3MCxcbiAgICAgICAgICBfX3Y6IDBcbiAgICAgICAgfSxcbiAgICAgICAgY291bnQ6IDFcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIF9pZDogXCI1YzZlNWQxNjdkODNiNjQ5ZDMyZTNjMGNcIixcbiAgICAgICAgaXRtOiB7XG4gICAgICAgICAgX2lkOiBcIjVjNjdiYmM3ZjAwNGM5M2VjZDcwMDZjMFwiLFxuICAgICAgICAgIG5hbWU6IFwiQXBwbGVcIixcbiAgICAgICAgICBwcm9kdWN0Q29kZTogMyxcbiAgICAgICAgICBwcmljZTogODAsXG4gICAgICAgICAgZGVzY3JpcHRpb246XG4gICAgICAgICAgICBcIkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0LCBjb25zZWN0ZXR1ciBhZGlwaXNjaW5nIGVsaXQuIERvbmVjIGlhY3VsaXMgbWV0dXMgZG9sb3IsIGF0IG1vbGxpcyBcIixcbiAgICAgICAgICBhdmFpbGFibGVDb3VudDogNjAwLFxuICAgICAgICAgIF9fdjogMFxuICAgICAgICB9LFxuICAgICAgICBjb3VudDogNFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgX2lkOiBcIjVjNmZjZTI3ZGVkZDczMzY0OTI0ZWQ2N1wiLFxuICAgICAgICBpdG06IHtcbiAgICAgICAgICBfaWQ6IFwiNWM2N2JjMDFmMDA0YzkzZWNkNzAwNmMyXCIsXG4gICAgICAgICAgbmFtZTogXCJNaWxrXCIsXG4gICAgICAgICAgcHJvZHVjdENvZGU6IDUsXG4gICAgICAgICAgcHJpY2U6IDIwMCxcbiAgICAgICAgICBkZXNjcmlwdGlvbjpcbiAgICAgICAgICAgIFwiTG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQsIGNvbnNlY3RldHVyIGFkaXBpc2NpbmcgZWxpdC4gRG9uZWMgaWFjdWxpcyBtZXR1cyBkb2xvciwgYXQgbW9sbGlzIFwiLFxuICAgICAgICAgIGF2YWlsYWJsZUNvdW50OiA0MDAsXG4gICAgICAgICAgX192OiAwXG4gICAgICAgIH0sXG4gICAgICAgIGNvdW50OiA0XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBfaWQ6IFwiNWM3Mzc5ZGU0MzE2MDgxYzdkZTY3MjA4XCIsXG4gICAgICAgIGl0bToge1xuICAgICAgICAgIF9pZDogXCI1YzY3YmMyOGYwMDRjOTNlY2Q3MDA2YzNcIixcbiAgICAgICAgICBuYW1lOiBcIkNoZWVzZVwiLFxuICAgICAgICAgIHByb2R1Y3RDb2RlOiA2LFxuICAgICAgICAgIHByaWNlOiAzNTAsXG4gICAgICAgICAgZGVzY3JpcHRpb246XG4gICAgICAgICAgICBcIkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0LCBjb25zZWN0ZXR1ciBhZGlwaXNjaW5nIGVsaXQuIERvbmVjIGlhY3VsaXMgbWV0dXMgZG9sb3IsIGF0IG1vbGxpcyBcIixcbiAgICAgICAgICBhdmFpbGFibGVDb3VudDogNzAsXG4gICAgICAgICAgX192OiAwXG4gICAgICAgIH0sXG4gICAgICAgIGNvdW50OiAxXG4gICAgICB9XG4gICAgXTtcblxuICAgIG1veGlvcy53YWl0KCgpID0+IHtcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSBtb3hpb3MucmVxdWVzdHMubW9zdFJlY2VudCgpO1xuICAgICAgcmVxdWVzdC5yZXNwb25kV2l0aCh7XG4gICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICByZXNwb25zZTogZXhwZWN0ZWRBcnJheVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBleHBlY3RlZEFjdGlvbnMgPSBbXG4gICAgICB7IHR5cGU6IHR5cGVzLkNBUlRfTE9BRElORyB9LFxuICAgICAge1xuICAgICAgICBwYXlsb2FkOiBleHBlY3RlZEFycmF5LFxuICAgICAgICB0eXBlOiB0eXBlcy5HRVRfQ0FSVFxuICAgICAgfVxuICAgIF07XG5cbiAgICBjb25zdCBzdG9yZSA9IG1vY2tTdG9yZSh7XG4gICAgICBjYXJ0SXRlbXM6IFtdLFxuICAgICAgdG90YWxBbW91bnQ6IDAsXG4gICAgICBjYXJ0TG9hZGluZzogZmFsc2UsXG4gICAgICBjYXJ0SWQ6IFwiNWM2YTRjMjI2YzdlMGEwZjJjN2VhMmZiXCJcbiAgICB9KTtcblxuICAgIHJldHVybiBzdG9yZS5kaXNwYXRjaChhY3Rpb25zLmdldENhcnQoKSkudGhlbigoKSA9PiB7XG4gICAgICAvLyByZXR1cm4gb2YgYXN5bmMgYWN0aW9uc1xuICAgICAgZXhwZWN0KHN0b3JlLmdldEFjdGlvbnMoKSkudG9FcXVhbChleHBlY3RlZEFjdGlvbnMpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZShcImFkZFRvQ2FydCBjYXJ0QWN0aW9uc1wiLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goZnVuY3Rpb24oKSB7XG4gICAgbW94aW9zLmluc3RhbGwoKTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKGZ1bmN0aW9uKCkge1xuICAgIG1veGlvcy51bmluc3RhbGwoKTtcbiAgfSk7XG5cbiAgdGVzdChcImNvcnJlY3RseVwiLCAoKSA9PiB7XG4gICAgbW94aW9zLndhaXQoKCkgPT4ge1xuICAgICAgY29uc3QgcmVxdWVzdCA9IG1veGlvcy5yZXF1ZXN0cy5tb3N0UmVjZW50KCk7XG4gICAgICByZXF1ZXN0LnJlc3BvbmRXaXRoKHtcbiAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgIHJlc3BvbnNlOiBbMSwgMiwgMywgNF1cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgY29uc3QgZXhwZWN0ZWRBY3Rpb25zID0gW1xuICAgICAge1xuICAgICAgICBwYXlsb2FkOiBbMSwgMiwgMywgNF0sXG4gICAgICAgIHR5cGU6IHR5cGVzLkFERF9UT19DQVJUXG4gICAgICB9XG4gICAgXTtcblxuICAgIGNvbnN0IHN0b3JlID0gbW9ja1N0b3JlKHsgY2FydEl0ZW1zOiBbXSwgdG90YWw6IDAsIGNhcnRMb2FkaW5nOiBmYWxzZSB9KTtcblxuICAgIGNvbnN0IGlkID0gXCI1YzZiZjZjZGQyMTA0YjYzNzlmZGY0OWNcIjtcbiAgICBjb25zdCBjb3VudCA9IDY7XG5cbiAgICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goYWN0aW9ucy5hZGRUb0NhcnQoaWQsIGNvdW50KSkudGhlbigoKSA9PiB7XG4gICAgICAvLyByZXR1cm4gb2YgYXN5bmMgYWN0aW9uc1xuICAgICAgZXhwZWN0KHN0b3JlLmdldEFjdGlvbnMoKSkudG9FcXVhbChleHBlY3RlZEFjdGlvbnMpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZShcImRlbGV0ZUZyb21DYXJ0IGNhcnRBY3Rpb25zXCIsICgpID0+IHtcbiAgYmVmb3JlRWFjaChmdW5jdGlvbigpIHtcbiAgICBtb3hpb3MuaW5zdGFsbCgpO1xuICB9KTtcblxuICBhZnRlckVhY2goZnVuY3Rpb24oKSB7XG4gICAgbW94aW9zLnVuaW5zdGFsbCgpO1xuICB9KTtcblxuICB0ZXN0KFwiY29ycmVjdGx5XCIsICgpID0+IHtcbiAgICBtb3hpb3Mud2FpdCgoKSA9PiB7XG4gICAgICBjb25zdCByZXF1ZXN0ID0gbW94aW9zLnJlcXVlc3RzLm1vc3RSZWNlbnQoKTtcbiAgICAgIHJlcXVlc3QucmVzcG9uZFdpdGgoe1xuICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgcmVzcG9uc2U6IHsgc3VjY2VzczogdHJ1ZSB9XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGlkID0gXCI1YzZiZjZjZGQyMTA0YjYzNzlmZGY0OWNcIjtcblxuICAgIGNvbnN0IGV4cGVjdGVkQWN0aW9ucyA9IFtcbiAgICAgIHtcbiAgICAgICAgcGF5bG9hZDogaWQsXG4gICAgICAgIHR5cGU6IHR5cGVzLkRFTEVURV9GUk9NX0NBUlRcbiAgICAgIH1cbiAgICBdO1xuXG4gICAgY29uc3Qgc3RvcmUgPSBtb2NrU3RvcmUoeyBjYXJ0SXRlbXM6IFtdLCB0b3RhbDogMCwgY2FydExvYWRpbmc6IGZhbHNlIH0pO1xuXG4gICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKGFjdGlvbnMuZGVsZXRlRnJvbUNhcnQoaWQpKS50aGVuKCgpID0+IHtcbiAgICAgIC8vIHJldHVybiBvZiBhc3luYyBhY3Rpb25zXG4gICAgICBleHBlY3Qoc3RvcmUuZ2V0QWN0aW9ucygpKS50b0VxdWFsKGV4cGVjdGVkQWN0aW9ucyk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKFwidXBkYXRlQ291bnQgY2FydEFjdGlvbnNcIiwgKCkgPT4ge1xuICBiZWZvcmVFYWNoKGZ1bmN0aW9uKCkge1xuICAgIG1veGlvcy5pbnN0YWxsKCk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaChmdW5jdGlvbigpIHtcbiAgICBtb3hpb3MudW5pbnN0YWxsKCk7XG4gIH0pO1xuXG4gIHRlc3QoXCJjb3JyZWN0bHlcIiwgKCkgPT4ge1xuICAgIG1veGlvcy53YWl0KCgpID0+IHtcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSBtb3hpb3MucmVxdWVzdHMubW9zdFJlY2VudCgpO1xuICAgICAgcmVxdWVzdC5yZXNwb25kV2l0aCh7XG4gICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICByZXNwb25zZTogeyBzdWNjZXNzOiB0cnVlIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgY29uc3QgaWQgPSBcIjVjNmJmNmNkZDIxMDRiNjM3OWZkZjQ5Y1wiO1xuICAgIGNvbnN0IGNvdW50ID0gNDtcblxuICAgIGNvbnN0IGV4cGVjdGVkQWN0aW9ucyA9IFtcbiAgICAgIHtcbiAgICAgICAgcGF5bG9hZDoge1xuICAgICAgICAgIGlkZDogaWQsXG4gICAgICAgICAgY291bnR0OiBjb3VudFxuICAgICAgICB9LFxuICAgICAgICB0eXBlOiB0eXBlcy5VUERBVEVfQ09VTlRcbiAgICAgIH1cbiAgICBdO1xuXG4gICAgY29uc3Qgc3RvcmUgPSBtb2NrU3RvcmUoeyBjYXJ0SXRlbXM6IFtdLCB0b3RhbDogMCwgY2FydExvYWRpbmc6IGZhbHNlIH0pO1xuXG4gICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKGFjdGlvbnMudXBkYXRlQ291bnQoaWQsIGNvdW50KSkudGhlbigoKSA9PiB7XG4gICAgICAvLyByZXR1cm4gb2YgYXN5bmMgYWN0aW9uc1xuICAgICAgZXhwZWN0KHN0b3JlLmdldEFjdGlvbnMoKSkudG9FcXVhbChleHBlY3RlZEFjdGlvbnMpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZShcImNsZWFyQ2FydCBjYXJ0QWN0aW9uc1wiLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goZnVuY3Rpb24oKSB7XG4gICAgbW94aW9zLmluc3RhbGwoKTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKGZ1bmN0aW9uKCkge1xuICAgIG1veGlvcy51bmluc3RhbGwoKTtcbiAgfSk7XG5cbiAgdGVzdChcImNvcnJlY3RseVwiLCAoKSA9PiB7XG4gICAgbW94aW9zLndhaXQoKCkgPT4ge1xuICAgICAgY29uc3QgcmVxdWVzdCA9IG1veGlvcy5yZXF1ZXN0cy5tb3N0UmVjZW50KCk7XG4gICAgICByZXF1ZXN0LnJlc3BvbmRXaXRoKHtcbiAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgIHJlc3BvbnNlOiB7IHN1Y2Nlc3M6IHRydWUgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBleHBlY3RlZEFjdGlvbnMgPSBbXG4gICAgICB7XG4gICAgICAgIHBheWxvYWQ6IHsgc3VjY2VzczogdHJ1ZSB9LFxuICAgICAgICB0eXBlOiB0eXBlcy5DTEVBUl9DQVJUXG4gICAgICB9XG4gICAgXTtcblxuICAgIGNvbnN0IHN0b3JlID0gbW9ja1N0b3JlKHsgY2FydEl0ZW1zOiBbXSwgdG90YWw6IDAsIGNhcnRMb2FkaW5nOiBmYWxzZSB9KTtcblxuICAgIHJldHVybiBzdG9yZS5kaXNwYXRjaChhY3Rpb25zLmNsZWFyQ2FydCgpKS50aGVuKCgpID0+IHtcbiAgICAgIC8vIHJldHVybiBvZiBhc3luYyBhY3Rpb25zXG4gICAgICBleHBlY3Qoc3RvcmUuZ2V0QWN0aW9ucygpKS50b0VxdWFsKGV4cGVjdGVkQWN0aW9ucyk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXX0=